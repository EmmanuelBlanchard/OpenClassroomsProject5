<!doctype html>
<html lang="fr">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>
			{% block title %}Bonjour !
			{% endblock %}
		</title>
		<link rel="stylesheet" href="{{ asset('css/style.css') }}">
		<link rel="stylesheet" href="{{ asset('css/offcanvas.css') }}"> 
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
		{% block stylesheets %}{% endblock %}
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
		<link rel="icon" type="image/x-icon" href="{{ asset('icons/favicon.ico') }}"/>
	</head>

	<body class="bg-light container">
		<nav class="navbar navbar-expand-lg fixed-top navbar-light bg-gray97" aria-label="Main navigation">
			<div class="container">
				<a class="navbar-brand aDivNavLogo" href="{{ path('app_home') }}">
					<img src="{{ asset('img/booksExchangeLogo.svg') }}" class="imgLogo" alt="mains avec livre effectuant un échange">
					<h1 class="brandNameExchange">Échange
						<span class="brandNameBook">Livres</span>
					</h1>
				</a>
				<button class="navbar-toggler p-0 border-0" type="button" data-bs-toggle="offcanvas" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="navbar-collapse offcanvas-collapse" id="navbarDefault">
					<ul class="navbar-nav mb-lg-0">
						<li class="nav-item">
							<a class="nav-link active" aria-current="page" href="{{ path('app_home') }}">Accueil</a>
						</li>
						{% if is_granted('ROLE_ADMIN') %}
							<li class="nav-item">
								<a class="nav-link nav-blue" href="{{ path('admin_home') }}">Tableau de bord</a>
							</li>
						{% endif %}
						{% if is_granted('ROLE_USER') %}
							<li class="nav-item">
								<a class="nav-link nav-blue" href="{{ path('app_logout') }}">Se déconnecter</a>
							</li>
						{% else %}
							<li class="nav-item">
								<a class="nav-link nav-blue" href="{{ path('app_register') }}">Créer mon compte</a>
							</li>
							<li class="nav-item">
								<a class="nav-link nav-blue" href="{{ path('app_login') }}">Connexion</a>
							</li>
						{% endif %}
					</ul>
				</div>
			</div>
		</nav>
		<div class="nav-scroller bg--body shadow-sm">
			<nav class="nav nav-underline" aria-label="Secondary navigation">
				<a class="nav-link" href="{{ path('app_how_it_works') }}">Comment ça marche</a>
				<a class="nav-link" href="{{ path('app_faq') }}">Foire aux questions</a>
				<a class="nav-link" href="{{ path('book_home') }}">Bibliothèque</a>
			</nav>
		</div>
		<main class="container">
			<aside class="hidden-print">
				<form action="{{ path('app_search') }}" id="search_form">
					<input
						class="form-control"
						type="search"
						name="search"
						id="search" 
						placeholder="Rechercher le titre d'un livre"
						{% if search is defined %}
							value = "{{ search }}"
						{% endif %}
					>
					<ul class="list-group" id="result"></ul>
					<button type="submit">Rechercher</button>
				</form>	
				{% if app.user %}
					<div class="informationAboutTheAccountTheLibraryTheExchanges">
						<h2 class="h2OfWelcomeOfFirstName">Salut
							{{ app.user.firstname }}
						</h2>
						<div class="divAboutTheAccountTheLibraryTheExchanges">
							<h3>Votre compte</h3>
							<a href="{{ path('user') }}" class="linkManageMyAccount">Gérer mon compte</a>
							<h3>Bibliothèque</h3>
							<a href="{{ path('book_my_books') }}" class="linkMyBooks">Mes livres</a>
							<h3>Échanges</h3>
							<a href="{{ path('book_how_make_exchange') }}">Comment faire un échange</a>
							<a href="{{ path('book_my_exchange_wishes') }}">Mes souhaits d'échange</a>
							<a href="{{ path('book_my_exchange_requests') }}">Mes sollicitations d'échange</a>
						</div>
					</div>
				{% endif %}
			</aside>
			{% block body %}{% endblock %}
		</main>
		{% block javascripts %}{% endblock %}
		<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js" integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT" crossorigin="anonymous"></script>
		<script src="{{ asset('js/offcanvas.js') }}"></script>
		<script src="{{ asset('js/jquery-3.6.0.js') }}"></script>

		<script>
			$(document).ready(function(){
				$('#search').keyup(function(){
					$('#result').html('');
					let searchField = $('#search').val();
					let expression = new RegExp(searchField, "i");
					$.getJSON('data.json', function(data){
						$.each(data, function(key, value){
							if(value.title.search(expression) != -1 || value.location.search(expression) != -1)
							{
								$('#result').append('<li class="list-group-item link-class"><img src="'+value.image+'" height="40" width="40" class="img-thumbnail" /> '+value.title+' | <span class="text-muted">'+value.location+'</span></li>');
							}
						});
					});
				});
				/*
				$('#result').on('click', 'li', function() {
					let click_text = $(this).text().split('|');
					$('#search').val($.trim(click_text[0]));
					$("#result").html('');
				});
				*/
			});
		</script>
	</body>
</html>
